[logic]
active = ph_door@close

[ph_door@close]
locked = false
closed = true
snd_open_start = metal_small_open
snd_close_start = metal_small_close_start
snd_close_stop = metal_small_close_stop
on_use = {=is_actor_enemy_to_faction(stalker)} ph_door@locked, ph_door@open
on_info = %-esc_trader_door_open%
on_info2 = {=is_night} ph_door@locked

[ph_door@open]
locked = false
closed = false
snd_open_start = metal_small_open
snd_close_start = metal_small_close_start
snd_close_stop = metal_small_close_stop
on_use = {=is_actor_enemy_to_faction(stalker)} ph_door@locked, ph_door@close
on_info = %+esc_trader_door_open%
on_timer = 4000 | ph_door@open_temp

[ph_door@open_temp]
locked = false
closed = false
snd_open_start = metal_small_open
snd_close_start = metal_small_close_start
snd_close_stop = metal_small_close_stop
on_use = {=is_actor_enemy_to_faction(stalker)} ph_door@locked, ph_door@close
on_info = %+esc_trader_door_open%
on_info2 = {=is_night} ph_door@locked
on_timer = 1 | ph_door@close

[ph_door@locked]
locked = true
closed = true
snd_open_start = metal_small_open
snd_close_start = metal_small_close_start
snd_close_stop = metal_small_close_stop
on_info = %-esc_trader_door_open%
on_info2 = %+esc_trader_door_locked%
on_info3 = {!is_night} ph_door@close, {+sidor_let_me_out} ph_door@open
